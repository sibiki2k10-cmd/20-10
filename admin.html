<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel | 20-10</title>
    <style>
        body { font-family: monospace; background: #111; color: #0f0; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; }
        
        /* Login Screen */
        #login-screen { text-align: center; margin-top: 100px; border: 1px solid #333; padding: 40px; border-radius: 10px; }
        input { background: #222; border: 1px solid #444; color: white; padding: 10px; margin: 5px; width: 80%; }
        button { background: #0f0; color: black; border: none; padding: 10px 20px; cursor: pointer; font-weight: bold; margin-top: 10px; }
        button:hover { background: #00cc00; }

        /* Dashboard */
        .msg-card { background: #1a1a1a; border-left: 4px solid #ff69b4; margin-bottom: 15px; padding: 15px; border-radius: 4px; }
        .meta { color: #888; font-size: 0.8rem; margin-bottom: 5px; display: flex; justify-content: space-between; }
        .content { font-size: 1.1rem; color: #eee; white-space: pre-wrap; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div class="container">
        <div id="login-screen">
            <h2>SYSTEM ACCESS</h2>
            <input type="text" id="user" placeholder="Username">
            <input type="password" id="pass" placeholder="Password">
            <br>
            <button onclick="login()">LOGIN</button>
            <p id="status" style="color:red; margin-top:10px"></p>
        </div>

        <div id="dashboard" class="hidden">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h2>ðŸ“¨ INBOX MESSAGES</h2>
                <button onclick="logout()" style="background:#d9534f; color:white">LOGOUT</button>
            </div>
            
            <button onclick="loadData()">ðŸ”„ Refresh Data</button>
            <div id="list" style="margin-top:20px">Loading...</div>
        </div>
    </div>

    <script>
        // --- Cáº¤U HÃŒNH: DÃN LINK SCRIPT Cá»¦A Báº N VÃ€O DÃ’NG DÆ¯á»šI ---
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyC9FPcqCNZIhh3nCA7o5I8Zlfxd8n8QdQuH31pQYw_tA7PYUrYmbIs6REK0ve7QngA/exec'; 

        function login() {
            const u = document.getElementById('user').value;
            const p = document.getElementById('pass').value;
            const status = document.getElementById('status');
            
            status.innerText = "Authenticating...";

            const formData = new FormData();
            formData.append('action', 'login');
            formData.append('user', u);
            formData.append('pass', p);

            fetch(SCRIPT_URL, { method: 'POST', body: formData })
            .then(res => res.json())
            .then(data => {
                if(data.status == 'success') {
                    document.getElementById('login-screen').classList.add('hidden');
                    document.getElementById('dashboard').classList.remove('hidden');
                    loadData();
                } else {
                    status.innerText = "âŒ Access Denied";
                }
            });
        }

        function loadData() {
            fetch(SCRIPT_URL + '?action=getMessages')
            .then(res => res.json())
            .then(data => {
                const list = document.getElementById('list');
                list.innerHTML = "";
                data.forEach(row => {
                    // row[0]=Time, row[1]=Name, row[2]=Message
                    list.innerHTML += `
                        <div class="msg-card">
                            <div class="meta">
                                <span>FROM: <b>${row[1]}</b></span>
                                <span>${row[0]}</span>
                            </div>
                            <div class="content">${row[2]}</div>
                        </div>
                    `;
                });
            })
            .catch(err => document.getElementById('list').innerHTML = "ChÆ°a cÃ³ tin nháº¯n nÃ o.");
        }

        function logout() { location.reload(); }
    </script>
</body>
</html>
